<!DOCTYPE html>
<html>

<head></head>

<body>
  <main>
    <button id="rock">rock</button>
    <button id="paper">paper</button>
    <button id="scissor">scissor</button>
  </main>


  <script>
    const main = document.querySelector('main');
    const resultsDiv = document.createElement('div');
    const announce = document.createElement('p');

    let pScore = 0;
    let cScore = 0;
    let announcement = '';

    resultsDiv.textContent = `Player score: ${pScore}\nComputer score: ${cScore}`;
    announce.textContent = announcement;

    // vvvv announce does not show up in browswer when inside div
    // resultsDiv.appendChild(announce);
    main.appendChild(resultsDiv);
    main.appendChild(announce);

    let computerPlay = () => {
      rand = Math.floor(Math.random() * 3) + 1; // random num from 1 to 3
      switch (rand) {
        case 1:
          return 'rock';
          break;
        case 2:
          return 'paper';
          break;
        case 3:
          return 'scissor';
          break;
      }
    };

    let playRound = (playerSelection, computerSelection) => {
      ps = playerSelection.toLowerCase();
      cs = computerSelection.toLowerCase();

      if (
        (ps === 'rock' && cs === 'scissor') ||
        (ps === 'paper' && cs === 'rock') ||
        (ps == 'scissor' && cs === 'paper')) {
        return ['player', `You win! ${ps} beats ${cs}`];
      } else if (
        (cs === 'rock' && ps === 'scissor') ||
        (cs === 'paper' && ps === 'rock') ||
        (cs == 'scissor' && ps === 'paper')) {
        return ['computer', `You lose! ${cs} beats ${ps}`];
      } else {
        return ['both', 'This is a tie'];
      }
    };

    let update = () => {
      console.log(announce);
      console.log(announcement);

      resultsDiv.textContent = `Player score: ${pScore}\nComputer score: ${cScore}`;
      announce.textContent = announcement;
    }

    let game = ps => {
      cs = computerPlay();
      let results = (playRound(ps, cs));

      announcement = results[1];
      if (results[0] === 'player') {
        ++pScore;
      } else if (results[0] === 'computer') {
        ++cScore;
      }
      update();
    };

    let count = 0;
    let winnerAnnounce = document.createElement('p');
    // winnerAnnounce.classList.add('winner-announcement');
    // winnerAnnounce.textContent = '';
    main.appendChild(winnerAnnounce);

    const buttons = document.querySelectorAll('button');
    buttons.forEach(button => {
      button.addEventListener('click', e => {
        game(e.target.id);
        ++count;
        console.log(count);
        if (count === 5) {
          count = 0;
          pScore = 0;
          cScore = 0;
          let winner;
          if (pScore > cScore) { winner = 'Player'; }
          else if (cScore > pScore) { winner = 'Computer' }
          else { winner = 'tie' }
          winnerAnnounce.textContent = winner !== 'tie' ? `${winner} wins!` : `This match is a ${winner}.`;
        }
      })
    });
  </script>
</body>

</html>